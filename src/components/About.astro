---
import { getAbout } from '../lib/sanity.js';

let about;
try {
  about = await getAbout();
} catch (error) {
  console.error('Error fetching about:', error);
  about = {
    title: "Built for growing B2B companies, not enterprise bureaucracy",
    content: [],
    edgePoints: []
  };
}

// Helper function to convert Sanity rich text to HTML
function blocksToText(blocks) {
  return blocks?.map(block => {
    if (block._type === 'block') {
      return block.children?.map(child => child.text).join('') || '';
    }
    return '';
  }).join('\n\n') || '';
}
---

<section id="about" class="section-textured py-16 relative section-divider">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 corner-accent">
    <div class="grid lg:grid-cols-2 gap-12 items-center">
      <div>
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">
          {about.title}
        </h2>
        <div class="space-y-4 text-lg text-gray-600">
          {blocksToText(about.content).split('\n\n').map(paragraph => (
            <p>{paragraph}</p>
          ))}
        </div>
      </div>
      
      <div class="bg-white rounded-lg p-8 shadow-sm">
        <h3 class="text-xl font-semibold text-gray-900 mb-6">Our Edge</h3>
        <ul class="space-y-4">
          {about.edgePoints?.map((point) => (
            <li class="flex items-start">
              <svg class="w-5 h-5 text-primary-500 mr-3 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
              </svg>
              <div>
                <div class="font-medium text-gray-900">{point.title}</div>
                <div class="text-gray-600">{point.description}</div>
              </div>
            </li>
          ))}
        </ul>
      </div>
    </div>
  </div>
</section>
