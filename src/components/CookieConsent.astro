---
---


<!-- Semi-transparent overlay - MUCH lighter -->
<div id="cookie-overlay" class="fixed inset-0 bg-white/10 backdrop-blur-sm z-[45] hidden transition-opacity duration-500"></div>
<!-- Cookie Consent Banner - Slides up from bottom -->
<div id="cookie-consent-banner" class="fixed bottom-0 left-0 right-0 bg-white border-t-2 border-gray-200 shadow-2xl z-50 transform translate-y-full transition-transform duration-500 ease-in-out">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <div class="flex flex-col lg:flex-row items-start lg:items-center gap-6">
      <!-- Content -->
      <div class="flex-1">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Cookie Preferences</h3>
        <p class="text-sm text-gray-600 leading-relaxed">
          We use cookies to provide essential website functionality. With your consent, 
          we also use analytics cookies to improve our site and marketing cookies for personalization. 
          You can accept all, decline optional cookies, or customize your choices.
          <a href="/privacy-policy/" class="text-primary-600 hover:underline font-medium ml-1">Learn more</a>
        </p>
      </div>
      
      <!-- Buttons - EQUAL PROMINENCE with hover effects -->
      <div class="flex flex-col sm:flex-row gap-3 w-full lg:w-auto lg:flex-shrink-0">
        <button 
          id="cookie-accept-all" 
          class="group px-6 py-3 bg-white text-gray-900 border-2 border-gray-900 rounded-lg font-medium transition-all duration-200 text-sm whitespace-nowrap cursor-pointer hover:bg-gray-900 hover:text-white hover:shadow-lg hover:scale-105"
        >
          <span class="flex items-center justify-center gap-2">
            Accept All
            <svg class="w-4 h-4 transition-transform group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          </span>
        </button>
        <button 
          id="cookie-essential-only" 
          class="group px-6 py-3 bg-white text-gray-900 border-2 border-gray-900 rounded-lg font-medium transition-all duration-200 text-sm whitespace-nowrap cursor-pointer hover:bg-gray-900 hover:text-white hover:shadow-lg hover:scale-105"
        >
          <span class="flex items-center justify-center gap-2">
            Essential Only
            <svg class="w-4 h-4 transition-transform group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
            </svg>
          </span>
        </button>
        <button 
          id="cookie-customize" 
          class="group px-6 py-3 bg-white text-gray-700 border-2 border-gray-300 rounded-lg font-medium transition-all duration-200 text-sm whitespace-nowrap cursor-pointer hover:bg-gray-50 hover:border-gray-400 hover:shadow-md hover:scale-105"
        >
          <span class="flex items-center justify-center gap-2">
            Customize
            <svg class="w-4 h-4 transition-transform group-hover:rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
          </span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Cookie Settings Modal -->
<div id="cookie-settings-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[60] hidden flex items-center justify-center p-4">
  <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-scale-in">
    <div class="p-6 sm:p-8">
      <div class="flex items-start justify-between mb-4">
        <h2 class="text-2xl font-bold">Customize Cookie Preferences</h2>
        <button id="close-settings-modal" class="text-gray-400 hover:text-gray-600 transition-colors cursor-pointer">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <p class="text-gray-600 mb-6">
        Choose which types of cookies you'd like to accept. Essential cookies cannot be disabled 
        as they're required for the website to function.
      </p>
      
      <div class="space-y-6">
        <!-- Essential Cookies -->
        <div class="pb-6 border-b border-gray-200">
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1">
              <h3 class="font-semibold text-gray-900 mb-2">Essential Cookies</h3>
              <p class="text-sm text-gray-600 mb-2">
                Required for the website to function properly. Always active.
              </p>
              <ul class="text-xs text-gray-500 list-disc list-inside space-y-1">
                <li>Cookie consent preferences</li>
                <li>Session management and security</li>
              </ul>
            </div>
            <div class="flex items-center h-6">
              <span class="text-sm text-gray-500 font-medium">Always Active</span>
            </div>
          </div>
        </div>
        
        <!-- Analytics Cookies -->
        <div class="pb-6 border-b border-gray-200">
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1">
              <h3 class="font-semibold text-gray-900 mb-2">Analytics Cookies</h3>
              <p class="text-sm text-gray-600 mb-2">
                Help us understand visitor behavior to improve our website.
              </p>
              <ul class="text-xs text-gray-500 list-disc list-inside space-y-1">
                <li>Google Analytics (anonymous statistics)</li>
                <li>Page views and user journeys</li>
              </ul>
            </div>
            <label class="relative inline-flex items-center cursor-pointer">
              <input type="checkbox" id="analytics-cookies" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600 hover:bg-gray-300 peer-checked:hover:bg-primary-700"></div>
            </label>
          </div>
        </div>
        
        <!-- Marketing Cookies -->
        <div>
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1">
              <h3 class="font-semibold text-gray-900 mb-2">Marketing Cookies</h3>
              <p class="text-sm text-gray-600 mb-2">
                Enable lead tracking, form analytics, and personalized marketing.
              </p>
              <ul class="text-xs text-gray-500 list-disc list-inside space-y-1">
                <li>HubSpot (form tracking and CRM)</li>
                <li>Apollo.io (website visitor tracking)</li>
                <li>LinkedIn Insights (conversion tracking)</li>
                <li>Google Ads (campaign measurement)</li>
                <li>Clay (web intent tracking)</li>
                <li>RB2B (website visitor identification)</li>
              </ul>
            </div>
            <label class="relative inline-flex items-center cursor-pointer">
              <input type="checkbox" id="marketing-cookies" class="sr-only peer">
              <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600 hover:bg-gray-300 peer-checked:hover:bg-primary-700"></div>
            </label>
          </div>
        </div>
      </div>
      
      <!-- Modal Buttons - EQUAL PROMINENCE with hover effects -->
      <div class="flex flex-col sm:flex-row gap-3 mt-8">
        <button 
          id="save-preferences" 
          class="group flex-1 bg-gray-900 text-white py-3 px-6 rounded-lg font-medium transition-all duration-200 cursor-pointer hover:bg-gray-800 hover:shadow-lg hover:scale-105"
        >
          <span class="flex items-center justify-center gap-2">
            Save Preferences
            <svg class="w-4 h-4 transition-transform group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          </span>
        </button>
        <button 
          id="cancel-customize" 
          class="group flex-1 sm:flex-initial px-6 py-3 border-2 border-gray-300 rounded-lg font-medium transition-all duration-200 cursor-pointer hover:bg-gray-50 hover:border-gray-400 hover:shadow-md"
        >
          <span class="flex items-center justify-center gap-2">
            Cancel
            <svg class="w-4 h-4 transition-transform group-hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </span>
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  @keyframes scale-in {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  .animate-scale-in {
    animation: scale-in 0.2s ease-out;
  }
</style>

<script>
  // Cookie management functionality
  const COOKIE_NAME = 'cookie-consent';
  const ANALYTICS_COOKIE = 'analytics-consent';
  const MARKETING_COOKIE = 'marketing-consent';
  const COOKIE_DURATION = 365; // days

  // Get elements
  const overlay = document.getElementById('cookie-overlay');
  const consentBanner = document.getElementById('cookie-consent-banner');
  const settingsModal = document.getElementById('cookie-settings-modal');
  const acceptAllBtn = document.getElementById('cookie-accept-all');
  const essentialOnlyBtn = document.getElementById('cookie-essential-only');
  const customizeBtn = document.getElementById('cookie-customize');
  const savePreferencesBtn = document.getElementById('save-preferences');
  const cancelCustomizeBtn = document.getElementById('cancel-customize');
  const closeSettingsBtn = document.getElementById('close-settings-modal');
  const analyticsCheckbox = document.getElementById('analytics-cookies');
  const marketingCheckbox = document.getElementById('marketing-cookies');

  // Cookie utilities
  function setCookie(name, value, days = COOKIE_DURATION) {
    const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
    document.cookie = `${name}=${value}; expires=${expires}; path=/; SameSite=Lax; Secure`;
  }

  function getCookie(name) {
    return document.cookie.split('; ').find(row => row.startsWith(name + '='))?.split('=')[1];
  }

  function isPrivacyPolicyPage() {
    return window.location.pathname.includes('/privacy-policy');
  }

  function showBanner() {
    // On privacy policy page, show banner but don't block page access
    if (!isPrivacyPolicyPage()) {
      overlay.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    consentBanner.classList.remove('translate-y-full');
  }

  function hideBanner() {
    overlay.classList.add('hidden');
    consentBanner.classList.add('translate-y-full');
    document.body.style.overflow = '';
  }

  function showSettingsModal() {
    settingsModal.classList.remove('hidden');
    hideBanner();
    // Load current settings
    analyticsCheckbox.checked = getCookie(ANALYTICS_COOKIE) === 'true';
    marketingCheckbox.checked = getCookie(MARKETING_COOKIE) === 'true';
    // Prevent body scroll (except on privacy policy page)
    if (!isPrivacyPolicyPage()) {
      document.body.style.overflow = 'hidden';
    }
  }

  function hideSettingsModal() {
    settingsModal.classList.add('hidden');
    document.body.style.overflow = '';
  }

  function loadAnalytics() {
    if (getCookie(ANALYTICS_COOKIE) === 'true') {
      const script = document.createElement('script');
      script.src = 'https://www.googletagmanager.com/gtag/js?id=G-4KS1WFE7DG';
      script.async = true;
      document.head.appendChild(script);
      
      script.onload = () => {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-4KS1WFE7DG', {
          'anonymize_ip': true,
          'cookie_flags': 'SameSite=Lax;Secure'
        });
      };
    }
  }

  function loadHubSpot() {
    if (getCookie(MARKETING_COOKIE) === 'true') {
      const script = document.createElement('script');
      script.src = 'https://js.hs-scripts.com/146805802.js';
      script.async = true;
      script.defer = true;
      script.id = 'hs-script-loader';
      document.head.appendChild(script);
      
      script.onload = () => {
        setTimeout(() => {
          window.dispatchEvent(new CustomEvent('hubspot-loaded'));
        }, 1000);
      };
    }
  }

  function loadApollo() {
  if (getCookie(MARKETING_COOKIE) === 'true') {
    // Load Apollo tracker script
    const apolloScript = document.createElement('script');
    const cacheKey = Math.random().toString(36).substring(7);
    apolloScript.src = `https://assets.apollo.io/micro/website-tracker/tracker.iife.js?nocache=${cacheKey}`;
    apolloScript.async = true;
    apolloScript.defer = true;
    
    apolloScript.onload = function() {
      // Initialize Apollo after script loads
      setTimeout(() => {
        if (window.trackingFunctions && typeof window.trackingFunctions.onLoad === 'function') {
          try {
            window.trackingFunctions.onLoad({
              appId: "6991cb2770812f0011b5edc0"
            });
          } catch (error) {
            console.error('Apollo initialization error:', error);
          }
        }
      }, 100);
    };
    
    apolloScript.onerror = function() {
      console.error('Failed to load Apollo tracking script');
    };
    
    document.head.appendChild(apolloScript);
  }
}

function loadLinkedIn() {
  if (getCookie(MARKETING_COOKIE) === 'true') {
    // Add LinkedIn Insight Tag
    window._linkedin_partner_id = "8301826"; // Replace with your actual Partner ID
    window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
    window._linkedin_data_partner_ids.push(window._linkedin_partner_id);

    (function(l) {
      if (!l) {
        window.lintrk = function(a, b) {
          window.lintrk.q.push([a, b]);
        };
        window.lintrk.q = [];
      }
      var s = document.getElementsByTagName("script")[0];
      var b = document.createElement("script");
      b.type = "text/javascript";
      b.async = true;
      b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
      s.parentNode.insertBefore(b, s);
    })(window.lintrk);
  }
}

function loadClay() {
  if (getCookie(MARKETING_COOKIE) === 'true') {
    const script = document.createElement('script');
    script.src = 'https://static.claydar.com/init.v1.js?id=cgiqWQbLzO';
    script.async = true;
    document.head.appendChild(script);
  }
}

function loadRB2B() {
  if (getCookie(MARKETING_COOKIE) === 'true') {
    if (window.reb2b) return;
    window.reb2b = { loaded: true };
    var s = document.createElement("script");
    s.async = true;
    s.src = "https://ddwl4m2hdecbv.cloudfront.net/b/Z6PVLHQGDP6R/Z6PVLHQGDP6R.js.gz";
    document.getElementsByTagName("script")[0].parentNode.insertBefore(s, document.getElementsByTagName("script")[0]);
  }
}

  function loadAllScripts() {
    loadAnalytics();
    loadHubSpot();
    loadApollo();
    loadLinkedIn();
    loadClay();
    loadRB2B();
  }

  // Event listeners
  acceptAllBtn.addEventListener('click', () => {
    setCookie(COOKIE_NAME, 'accepted');
    setCookie(ANALYTICS_COOKIE, 'true');
    setCookie(MARKETING_COOKIE, 'true');
    hideBanner();
    loadAllScripts();
    window.dispatchEvent(new CustomEvent('cookie-consent-changed', { detail: { all: true } }));
  });

  essentialOnlyBtn.addEventListener('click', () => {
    setCookie(COOKIE_NAME, 'essential-only');
    setCookie(ANALYTICS_COOKIE, 'false');
    setCookie(MARKETING_COOKIE, 'false');
    hideBanner();
    window.dispatchEvent(new CustomEvent('cookie-consent-changed', { detail: { all: false } }));
  });

  customizeBtn.addEventListener('click', showSettingsModal);
  
  cancelCustomizeBtn.addEventListener('click', () => {
    hideSettingsModal();
    showBanner();
  });

  closeSettingsBtn.addEventListener('click', () => {
    hideSettingsModal();
    showBanner();
  });

  savePreferencesBtn.addEventListener('click', () => {
    setCookie(COOKIE_NAME, 'customized');
    setCookie(ANALYTICS_COOKIE, analyticsCheckbox.checked.toString());
    setCookie(MARKETING_COOKIE, marketingCheckbox.checked.toString());
    hideSettingsModal();
    loadAllScripts();
    window.dispatchEvent(new CustomEvent('cookie-consent-changed', { 
      detail: { 
        analytics: analyticsCheckbox.checked,
        marketing: marketingCheckbox.checked
      }
    }));
  });

  // Initialize - show banner after short delay if no consent
  const existingConsent = getCookie(COOKIE_NAME);
  if (!existingConsent) {
    // Show banner after 800ms - visible but not jarring
    setTimeout(showBanner, 800);
  } else {
    // Load scripts based on existing preferences
    loadAllScripts();
  }

  // Expose function to allow users to change preferences later
  window.openCookiePreferences = () => {
    showSettingsModal();
  };
</script>